# ROOTME

- Truy c·∫≠p v√†o trang web nh∆∞ sau, sau khi F12 v√† kh√¥ng c√≥ th√¥ng tin g√¨ h·ªØu √≠ch, m√¨nh ti·∫øn h√†nh scan xem th·ª≠ trang web c√≥ directory ·∫©n n√†o kh√¥ng.

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled.png)

payload scan: ffuf `-w common.txt -u http://10.10.178.152/FUZZ -fc 404 -fs 0`

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%201.png)

- Sau khi scan xong m√¨nh ph√°t hi·ªán `/panel` s·∫Ω d·∫´n ta v√†o 1 trang c√≥ th·ªÉ upload

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%202.png)

- M√¨nh c√≥ th·ª≠ up file .php l√™n tuy nhi√™n c√≥ v·∫ª nh∆∞ trang web kh√¥ng cho ph√©p ƒëu√¥i c√≥ d·∫°ng l√† .php, th·∫ø n√™n m√¨nh th·ª≠ ƒë·ªïi sang ƒë·ªãnh d·∫°ng kh√°c l√† php5 th√¨ bypass ƒë∆∞·ª£c filter ‚úåüèº
- M√¨nh up file shell.phtml c√≥ n·ªôi dung nh∆∞ sau:

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%203.png)

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%204.png)

- Truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n upload v√† test

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%205.png)

- Sau khi ch·∫°y shell th√†nh c√¥ng, m√¨nh ti·∫øn h√†nh t√¨m flag ƒë·∫ßu ti√™n

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%206.png)

Chi ti·∫øt h∆°n v·ªÅ l·ªánh n√†y: `?cmd=find / -name user.txt 2>/dev/null`

- **`find`**: L·ªánh d√πng ƒë·ªÉ t√¨m ki·∫øm t·ªáp v√† th∆∞ m·ª•c trong c·∫•u tr√∫c th∆∞ m·ª•c.
- **`/`**: Th∆∞ m·ª•c g·ªëc, n∆°i b·∫Øt ƒë·∫ßu t√¨m ki·∫øm.
- **`name user.txt`**: T√πy ch·ªçn cho bi·∫øt c·∫ßn t√¨m ki·∫øm c√°c t·ªáp c√≥ t√™n l√† "user.txt".
- **`2>/dev/null`**: H∆∞·ªõng d·∫´n h·ªá th·ªëng ƒë·ªÉ ·∫©n ƒëi b·∫•t k·ª≥ l·ªói n√†o xu·∫•t hi·ªán trong qu√° tr√¨nh t√¨m ki·∫øm. T√πy ch·ªçn **`2>`** chuy·ªÉn h∆∞·ªõng l·ªói (stderr) v√† **`/dev/null`** l√† n∆°i c√°c l·ªói ƒë∆∞·ª£c g·ª≠i ƒë·∫øn v√† b·ªã lo·∫°i b·ªè.

Nh∆∞ v·∫≠y, l·ªánh n√†y t√¨m ki·∫øm t·∫•t c·∫£ c√°c t·ªáp c√≥ t√™n l√† "user.txt" t·ª´ th∆∞ m·ª•c g·ªëc v√† c√°c th∆∞ m·ª•c con, v√† kh√¥ng hi·ªÉn th·ªã b·∫•t k·ª≥ th√¥ng b√°o l·ªói n√†o n·∫øu c√≥.

- Sau khi bi·∫øt ƒë∆∞·ª£c v√≠ tr√≠ c·ªßa user.txt, ta ti·∫øn h√†nh ƒë·ªçc thui

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%207.png)

- ·ªû flag ti·∫øp theo, ta ph·∫£i s·ª≠ d·ª•ng reverse shell ƒë·ªÉ l√†m, v√¨ th·∫ø m√¨nh ti·∫øn h√†nh up file rev shell l√™n h·ªá th·ªëng. C√°c b·∫°n c√≥ th·ªÉ search gg key ‚Äú reverse shell ‚Äú

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%208.png)

- Sau khi k·∫øt n·ªëi v√†o ƒë∆∞·ª£c shell

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%209.png)

- ƒê·ªÉ t√¨m ki·∫øm c√°c t·ªáp c√≥ quy·ªÅn SUID (Set user ID) trong Linux, b·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh find nh∆∞ sau: `find / -perm -4000 -type f -print`

C√°ch ho·∫°t ƒë·ªông:

- `find:` l·ªánh ƒë·ªÉ t√¨m ki·∫øm c√°c t·ªáp trong h·ªá th·ªëng
- `/:` b·∫Øt ƒë·∫ßu t√¨m ki·∫øm t·ª´ th∆∞ m·ª•c g·ªëc
- `-perm -4000`: t√¨m c√°c t·ªáp c√≥ quy·ªÅn t·ª©c l√† c√≥ bit SUID ƒë∆∞·ª£c b·∫≠t
- `-type f`: ch·ªâ t√¨m c√°c t·ªáp th√¥ng th∆∞·ªùng, kh√¥ng ph·∫£i th∆∞ m·ª•c
- `-print`: in ra ƒë∆∞·ªùng d·∫´n c√°c t·ªáp t√¨m th·∫•y
- Sau khi t√¨m ki·∫øm, m√¨nh ph√°t hi·ªán th∆∞ m·ª•c `/usr/bin/python` , th∆∞ m·ª•c n√†y nguy hi·ªÉm v√† kh√¥ng n√™n ƒë∆∞·ª£c c·∫•p quy·ªÅn SUID v√¨ n√≥ cho ph√©p ng∆∞·ªùi d√πng th∆∞·ªùng c√≥ th·ªÉ ch·∫°y c√°c t·ªáp python v·ªõi quy·ªÅn root. ƒêi·ªÅu n√†y r·∫•t nguy hi·ªÉm v√¨ hacker c√≥ th·ªÉ t·∫°o m·ªôt script Python ƒë·ªôc h·∫°i v√† ch·∫°y n√≥ v·ªõi ƒë·∫∑c quy·ªÅn cao, c√≥ kh·∫£ nƒÉng l√†m h·ªèng h·ªá th·ªëng ho·∫∑c ƒë√°nh c·∫Øp d·ªØ li·ªáu nh·∫°y c·∫£m.

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%2010.png)

- M√¨nh s·ª≠ d·ª•ng payload sau: `python -c 'import os; os.execl("/bin/sh", "sh", "-p")‚Äô`
1. **`python`**: ƒê√¢y l√† l·ªánh ƒë·ªÉ ch·∫°y m·ªôt ch∆∞∆°ng tr√¨nh Python t·ª´ d√≤ng l·ªánh.
2. **`c 'import os; os.execl("/bin/sh", "sh", "-p")'`**: ƒê√¢y l√† c·ªù **`c`** c·ªßa Python, cho ph√©p b·∫°n ch·∫°y m·ªôt ƒëo·∫°n m√£ Python ng·∫Øn t·ª´ d√≤ng l·ªánh.
    
    Trong ƒëo·∫°n m√£ Python ƒë∆∞·ª£c th·ª±c thi c√≥ hai ph·∫ßn ch√≠nh:
    
    - **`import os`**: ƒê√¢y l√† l·ªánh Python ƒë·ªÉ nh·∫≠p th∆∞ vi·ªán **`os`**, gi√∫p b·∫°n t∆∞∆°ng t√°c v·ªõi h·ªá ƒëi·ªÅu h√†nh.
    - **`os.execl("/bin/sh", "sh", "-p")`**: ƒê√¢y l√† l·ªánh s·ª≠ d·ª•ng h√†m **`execl()`** trong th∆∞ vi·ªán **`os`** ƒë·ªÉ th·ª±c thi ch∆∞∆°ng tr√¨nh **`/bin/sh`** (m·ªôt b·∫£n d·ªãch c·ªßa shell Unix) v·ªõi c·ªù **`p`**. C·ªù **`p`** trong tr∆∞·ªùng h·ª£p n√†y s·ª≠ d·ª•ng ch·∫ø ƒë·ªô b·∫£o v·ªá, gi·ªØ c√°c bi·∫øn m√¥i tr∆∞·ªùng hi·ªán t·∫°i c·ªßa shell.
    
    ![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%2011.png)
    
- Ti·∫øp ƒë√≥ m√¨nh d√πng `find / -name '*.txt' 2>/dev/null`
- **`find`**: L·ªánh t√¨m ki·∫øm c√°c t·ªáp v√† th∆∞ m·ª•c trong c·∫•u tr√∫c th∆∞ m·ª•c.
- **`/`**: Th∆∞ m·ª•c g·ªëc, n∆°i b·∫Øt ƒë·∫ßu t√¨m ki·∫øm.
- **`name '*.txt'`**: T√πy ch·ªçn ƒë·ªÉ t√¨m ki·∫øm c√°c t·ªáp c√≥ ph·∫ßn m·ªü r·ªông l√† ".txt".

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%2012.png)

- Sau khi ph√°t hi·ªán, m√¨nh ch·ªâ c·∫ßn cat ƒë·ªÉ ƒë·ªçc file l√† xong

![Untitled](ROOTME%209f37bce9a8244e1fa4a76ee994a448d0/Untitled%2013.png)