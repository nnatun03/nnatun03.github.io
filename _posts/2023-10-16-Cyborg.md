---
title: Write-Up Cyborg
date: 2023-10-16 12:34:01 +0700
categories: [CTF, TryHackMe, Write-Up]
tags: [web, write-up, ctf]     # TAG names should always be lowercase
---
# Cyborg

- á» bÃ i nÃ y cÃ¡c cÃ¢u há»i vá» sá»­ dá»¥ng nmap mÃ¬nh sáº½ Ä‘á»ƒ Ä‘Ã¡p Ã¡n bÃªn dÆ°á»›i vÃ¬ nÃ³ khÃ¡ dá»… ğŸ˜½

<img src="/assets/writeup/cookie/Cyborg/Untitled.png">
- Tiáº¿n hÃ nh truy cáº­p vÃ o http://10.10.49.105

<img src="/assets/writeup/cookie/Cyborg/Untitled 1.png">

- MÃ¬nh dÃ¹ng FFUF Ä‘á»ƒ scan directory áº©n

payload scan: `ffuf -w common.txt -u http://10.10.49.105/FUZZ -fc 403 -s`

<img src="/assets/writeup/cookie/Cyborg/Untitled 2.png">

- Thá»­ truy cáº­p vÃ o `/admin`

<img src="/assets/writeup/cookie/Cyborg/Untitled 3.png">

- Test cÃ¡c chá»©c nÄƒng thÃ¬ á»Ÿ má»¥c Admins thÃ¬ mÃ¬nh phÃ¡t hiá»‡n trong cuá»™c trÃ² chuyá»‡n cÃ³ Ä‘á» cáº­p tá»›i 1 file backup lÃ  **music_archive.**

<img src="/assets/writeup/cookie/Cyborg/Untitled 4.png">

- MÃ¬nh click vÃ o má»¥c Archive vÃ  chá»n Download

<img src="/assets/writeup/cookie/Cyborg/Untitled 5.png">

- ThÃ¬ thÆ° má»¥c archive.tar sáº½ Ä‘Æ°á»£c táº£i vá»

<img src="/assets/writeup/cookie/Cyborg/Untitled 6.png">

- MÃ¬nh sá»­ dá»¥ng VS-CODE Ä‘á»ƒ giáº£i nÃ©n vÃ  xem táº¥t cáº£ cÃ¡c file thÃ¬ cÃ³ váº» nhÆ° Ä‘Ã¢y lÃ  1 hint liÃªn quan tá»›i viá»‡c sá»­ dá»¥ng Borg Ä‘á»ƒ backup dá»¯ liá»‡u

<img src="/assets/writeup/cookie/Cyborg/Untitled 7.png">

- Sau khi tÃ¬m hiá»ƒu vá» Borg backup, mÃ¬nh tiáº¿n hÃ nh cÃ i Ä‘áº·t Borg vá» kali báº±ng lá»‡nh
`sudo apt install borgbackup -y`
- Sau Ä‘Ã³ mÃ¬nh táº¡o 1 thÆ° má»¥c má»›i vÃ  giáº£i nÃ©n toÃ n bá»™ file báº±ng Borg

<img src="/assets/writeup/cookie/Cyborg/Untitled 8.png">

- Tuy nhiÃªn mÃ¬nh cáº§n pháº£i cÃ³ máº­t kháº©u Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng borg. LÃºc nÃ y mÃ¬nh thá»­ truy cáº­p vÃ o Ä‘Æ°á»ng dáº«n `/etc` lÃºc nÃ£y scan ra

<img src="/assets/writeup/cookie/Cyborg/Untitled 9.png">

- LÆ°u Ä‘oáº¡n Ä‘Ã³ vá» vÃ  mÃ¬nh dÃ¹ng john Ä‘á»ƒ decrypt

Payload john: `john hash --wordlist=/usr/share/wordlists/rockyou.txt`

<img src="/assets/writeup/cookie/Cyborg/Untitled 10.png">

- Sau khi cÃ³ Ä‘Æ°á»£c máº­t kháº©u mÃ¬nh tiáº¿n hÃ nh dÃ¹ng Ä‘á»ƒ giáº£i nÃ©n thÃ¬ xuáº¥t hiá»‡n thÆ° má»¥c alex

<img src="/assets/writeup/cookie/Cyborg/Untitled 11.png">

- TÃ¬m mÃ² thÃ¬ mÃ¬nh phÃ¡t hiá»‡n Ä‘Æ°á»£c tÃ i khoáº£n vÃ  máº­t kháº©u, cÃ³ váº» nhÆ° ta pháº£i SSH vÃ o vÃ¬ bÃ i nÃ y cÃ³ xuáº¥t hiá»‡n port 22 cháº¡y SSH

<img src="/assets/writeup/cookie/Cyborg/Untitled 12.png">

<img src="/assets/writeup/cookie/Cyborg/Untitled 13.png">

- Sau khi truy cáº­p vÃ o, mÃ¬nh tiáº¿n hÃ nh tÃ¬m flag tÃªn root.txt, thÆ°á»ng thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c giáº¥u á»Ÿ /root vÃ  ta sáº½ khÃ´ng cÃ³ quyá»n truy cáº­p vÃ o, vÃ¬ tháº¿ mÃ¬nh tiáº¿n hÃ nh tÃ¬m thá»­ xem cÃ³ nhá»¯ng thÆ° má»¥c nÃ o Ä‘Æ°á»£c cáº¥p SUID mÃ  ta cÃ³ thá»ƒ khai thÃ¡c khÃ´ng
- dÃ¹ng lá»‡nh `sudo -l` Ä‘á»ƒ xem file nÃ o cÃ³ quyá»n

<img src="/assets/writeup/cookie/Cyborg/Untitled 14.png">

- CÃ³ váº» nhÆ° táº¥t cáº£ lá»‡nh náº¿u nhÆ° cháº¡y á»Ÿ /etc/mp3backups/backup.sh Ä‘á»u Ä‘Æ°á»£c cáº¥p quyá»n root.

<img src="/assets/writeup/cookie/Cyborg/Untitled 15.png">

```visual-basic
alex@ubuntu:~$ chmod 777 /etc/mp3backups/backup.sh

alex@ubuntu:~$ echo "/bin/bash" > /etc/mp3backups/backup.sh

alex@ubuntu:~$ sudo /etc/mp3backups/backup.sh

root@ubuntu:~# whoami

root
```

Äoáº¡n code trÃªn thá»±c hiá»‡n khai thÃ¡c lá»— há»•ng quyá»n thá»±c thi táº­p lá»‡nh Ä‘á»ƒ leo thang Ä‘áº·c quyá»n lÃªn root.

- DÃ²ng 1: Cáº¥p quyá»n 777 (cÃ³ thá»ƒ Ä‘á»c, ghi, thá»±c thi) cho file /etc/mp3backups/backup.sh
- DÃ²ng 2: Ghi ná»™i dung "/bin/bash" vÃ o file backup.sh (táº¡o thÃ nh má»™t táº­p lá»‡nh)
- DÃ²ng 3: Cháº¡y táº­p lá»‡nh backup.sh vá»›i quyá»n sudo
- Do cÃ³ quyá»n sudo nÃªn táº­p lá»‡nh sáº½ cháº¡y vá»›i quyá»n root
- Táº­p lá»‡nh chá»‰ chá»©a "/bin/bash" nÃªn sáº½ má»Ÿ má»™t shell má»›i vá»›i quyá»n root
- DÃ²ng 4: In ra user hiá»‡n táº¡i Ä‘á»ƒ kiá»ƒm tra lÃ  root

NhÆ° váº­y, ta Ä‘Ã£ khai thÃ¡c lá»— há»•ng quyá»n thá»±c thi táº­p lá»‡nh Ä‘á»ƒ nháº­n Ä‘Æ°á»£c quyá»n root trÃªn há»‡ thá»‘ng. ÄÃ¢y lÃ  má»™t ká»¹ thuáº­t leo thang Ä‘áº·c quyá»n phá»• biáº¿n.

DONEEEE

<img src="/assets/writeup/cookie/Cyborg/Untitled 16.png">
